language: c
before_install:
  - sudo add-apt-repository -y ppa:terry.guo/gcc-arm-embedded
  - sudo apt-get update -qq
  - sudo apt-get install -qq gcc-arm-none-eabi
before_script:
 - arm-none-eabi-gcc --version
compiler:
  - gcc
env:
  matrix:
    - CONFIG=teensy-lc/nsh
    - CONFIG=sama5d4-ek/nsh
    - CONFIG=stm32f4discovery/netnsh
script:
  - cd nuttx
  - make -s distclean
  - sed -ri "s/^CONFIG_HOST_WINDOWS=y/CONFIG_HOST_LINUX=y/" configs/$CONFIG/defconfig
  - sed -ri "s/^CONFIG_WINDOWS_CYGWIN=y/#/" configs/$CONFIG/defconfig
  - sed -ri "s/^CONFIG_ARMV7M_TOOLCHAIN_.+=y/CONFIG_ARMV7M_TOOLCHAIN_GNU_EABIL=y/" configs/$CONFIG/defconfig
  - pushd tools && ./configure.sh $CONFIG && popd
  - make -s
